<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
		 xmlns:s="library://ns.adobe.com/flex/spark"
		 xmlns:view="com.view.*"
		 width="820" height="500" creationComplete="bordercontainer1_creationCompleteHandler(event)"
		 fontSize="18">
	<fx:Script>
		<![CDATA[
			import com.amusement.Mahjong.MahjongAppliction;
			import com.amusement.Mahjong.control.MahjongApplictionControl;
			import com.amusement.Mahjong.service.MahjongSyncService;
			import com.control.DanjiHomeControl;
			import com.control.MainSenceControl;
			import com.mahjongSyncServer.model.Player;
			import com.mahjongSyncServer.services.RoomService;
			import com.model.Alert;
			import com.services.DataService;
			
			import mx.collections.ArrayList;
			import mx.events.FlexEvent;
			
			protected function bordercontainer1_creationCompleteHandler(event:FlexEvent):void
			{
				new DanjiHomeControl(this);
				
				this.spiner.addEventListener(TouchEvent.TOUCH_TAP,tabHandler);
				this.spiner.addEventListener(MouseEvent.CLICK,clickHandler);
				
			}
			
			private function clickHandler(e:MouseEvent):void{
				operation.visible = true;
			}
			
			private function tabHandler(e:TouchEvent):void{
				operation.visible = true;
			}
			
			public function button1_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				if(DataService.players.length == 0){
					operation.visible = false;
					Alert.show("请先创建帐户！");
					return;
				}
				
				operation.visible = false;
				MahjongApplictionControl.instance._mahjongAppliction.mahjongRoom.visible = true;
				this.visible = false;
				MahjongSyncService.instance.isNetwork = false;
//				MahjongSyncService.instance.connServer(DataService.getPlayerByIndex(players.selectedIndex).playerName);
				
				RoomService.instance.beginGame(DataService.getPlayerByIndex(players.selectedIndex).playerName, DataService.getPlayerByIndex(players.selectedIndex).haveMoney);
				
			}
			
			protected function button2_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				operation.visible = false;
			}
			
			protected function button3_clickHandler(event:MouseEvent):void
			{
				if(players.selectedIndex == -1){
					Alert.show("请先创建帐户！");
					operation.visible = false;
					return;
				}
				// TODO Auto-generated method stub
				DataService.instance.removePlayer(DataService.getPlayerByIndex(players.selectedIndex).id, DataService.getPlayerByIndex(players.selectedIndex).playerName);
				operation.visible = false;
			}
			
			protected function button4_clickHandler(event:MouseEvent):void
			{
				if(players.selectedIndex == -1){
					Alert.show("请先创建帐户！");
					operation.visible = false;
					return;
				}
				// TODO Auto-generated method stub
				RoomService.instance.userName = DataService.getPlayerByIndex(players.selectedIndex).playerName;
				DataService.instance.getGameHistory(DataService.getPlayerByIndex(players.selectedIndex).playerName);
			}
			
			protected function closeB_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				this.visible = false;
//				MahjongApplictionControl.instance._mahjongAppliction.danjiB.visible = true;
//				MahjongApplictionControl.instance._mahjongAppliction.lianwangB.visible = true;
			}
			
			protected function image1_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				// TODO Auto-generated method stub
				RoomService.instance.userName = DataService.getPlayerByIndex(players.selectedIndex).playerName;
				DataService.instance.getGameHistory(DataService.getPlayerByIndex(players.selectedIndex).playerName);
			}
			
			protected function image2_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				operation.visible = false;
				MainSenceControl.instance.mainSence.mahjongAppliction.visible = true;
				MahjongApplictionControl.instance._mahjongAppliction.mahjongRoom.visible = true;
				this.visible = false;
				MahjongSyncService.instance.isNetwork = false;
				//				MahjongSyncService.instance.connServer(DataService.getPlayerByIndex(players.selectedIndex).playerName);
				
				RoomService.instance.beginGame(DataService.getPlayerByIndex(players.selectedIndex).playerName, DataService.getPlayerByIndex(players.selectedIndex).haveMoney);
				
			}
			
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>

		<s:SpinnerListContainer visible="false" id="spiner" horizontalCenter="0" verticalCenter="-180" width="800" height="0" alpha="0.3">
			<s:SpinnerList id="players" width="100%" height="182" color="#FFFFFF" fontSize="26"
						   fontWeight="bold" selectedIndex="10">

			</s:SpinnerList>
		</s:SpinnerListContainer>
	
	<s:BorderContainer id="operation" borderVisible="false" dropShadowVisible="true" visible="false" width="150" height="250" horizontalCenter="0" verticalCenter="0" cornerRadius="10" backgroundColor="#000000" backgroundAlpha="0.3">
		<s:Button y="24" width="120" height="45" label="开始游戏" click="button1_clickHandler(event)"
				  horizontalCenter="0"/>
		<s:Button y="75" width="120" height="45" label="游戏记录" click="button4_clickHandler(event)" enabled="true" horizontalCenter="0"/>
		<s:Button y="128" width="120" height="45" label="删除档案" click="button3_clickHandler(event)"
				  horizontalCenter="0"/>
		<s:Button y="178" width="120" height="45" label="关闭" click="button2_clickHandler(event)"
				  horizontalCenter="0"/>
		
	</s:BorderContainer>
	<view:PlayerAdd id="playerAdd" visible="false" horizontalCenter="0" verticalCenter="-300">
	</view:PlayerAdd>
	<view:History id="history" visible="false" horizontalCenter="0" verticalCenter="0">
	</view:History>
	<s:Image x="240" y="282" click="image2_clickHandler(event)"
			 source="assets/danji/danji_beginB.png"/>
	<s:Image x="432" y="282" click="image1_clickHandler(event)" source="assets/danji/danji_logB.png"/>
	<s:Image id="danji_exitB" x="518" y="195" source="assets/danji/danji_exitB.png" visible="false"/>
	<s:Image horizontalCenter="0" source="com/amusement/Mahjong/assets/danji_logo.png"
			 verticalCenter="-70"/>
</s:Group>
